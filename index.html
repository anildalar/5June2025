<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    </head>
    <body>
        <div class="container">
            <div class="row mt-5">
                <div class="col-8 offset-2">
                    <form>
                        <input type="text" name="car_name" class="form-control form-control-lg mb-4" placeholder="Enter your Car Name" />
                        <div class="d-grid">
                            <input type="submit" value="Save" class="btn btn-primary btn-lg" onclick="sendData(event)" />
                        </div>
                    </form >
                </div>
            </div>
            <div class="row mt-5">
                <div class="col-8 offset-2">
                    <table class="table table-success">
                        <thead>
                            <tr>
                                <th>Car Name</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-success">
                                <td>Tata Nexon</td>
                                <td>
                                    <button class="btn btn-sm btn-success">View</button>
                                    <button class="btn btn-sm btn-info">Edit</button>
                                    <button class="btn btn-sm btn-danger">Delete</button>
                                </td>
                            </tr>
                            <tr>
                                <td>Tata Safari</td>
                                <td>
                                    <button class="btn btn-sm btn-success">View</button>
                                    <button class="btn btn-sm btn-info">Edit</button>
                                    <button class="btn btn-sm btn-danger">Delete</button>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                             <tr>
                                <th></th>
                            </tr>
                        </tfoot> 
                    </table>
                </div>
            </div>
            
        </div>
        

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
        <script>
            //1. Function defination
            function sendData(e){ // e is a formal argument
                //object.method();
                e.preventDefault(); // To stop page reloading
                console.log('I am inside anil function');
                //I want to access form data here..
                //On which element this event is happening ?
                //Traversing Up
                console.log(e.target.closest('form'));

                //Traversing Down
                console.log(e.target.closest('form').querySelector('input:first-child').value);
                var cname = e.target.closest('form').querySelector('input:first-child').value;


                //let ceo1 = new ClassName();
                const xhr = new XMLHttpRequest(); 
                xhr.onreadystatechange = function() {
                    
                    if (this.readyState == 4 && this.status == 201) {
                        alert("Car Saved Successfully");
                    }
                    /*
                    1.
                    if (this.readyState == 4 && this.status == 201) {
                        alert("Car Saved Successfully");
                    }
                    2.
                    if (true && true) {
                        alert("Car Saved Successfully");
                    }
                    3.
                    if (true) {
                        alert("Car Saved Successfully");
                    }
                    */
                };   
                //I am setting the Headers
                xhr.open("POST", "http://localhost:1337/api/cars", true);

                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.setRequestHeader("Accept", "application/json"); 

                //object.member
                //1. object.property
                //2. object.method(aa1,aa2); //camleCase
               
                // Optional: If authentication is required
                // xhr.setRequestHeader("Authorization", "Bearer YOUR_JWT_TOKEN");
                const data = {
                    data: {
                        car_name: cname,
                    }
                };
                xhr.send(JSON.stringify(data));

            }
        </script>
    </body>
</html>